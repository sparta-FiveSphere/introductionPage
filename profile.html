<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>개인 페이지</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        /*폰트 가져오기*/
        @import url('https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Gowun+Dodum&family=Parkinsans:wght@300..800&display=swap');

        /*폰트 적용*/
        * {
            font-family: "Gowun Dodum", serif;
        }

        .intro {
            background-color: skyblue;
            height: 150px;
        }

        .hello {
            margin-top: 30px;
        }
    </style>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // Firebase 구성 정보 설정
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            
        };

        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // URL 파라미터에서 document_id 가져오기
        const urlParams = new URLSearchParams(window.location.search);
        const documentId = urlParams.get("document_id");

        // Firestore에서 데이터 가져오기
        async function getMemberData(documentId) {
            if (!documentId) {
                console.error("Invalid document ID.");
            } else {
                const docRef = doc(db, "members", documentId);
                getDoc(docRef)
                    .then((docSnap) => {
                        if (docSnap.exists()) {
                            const data = docSnap.data();

                            // 업데이트: 멤버 이름으로 h4 내용 설정
                            document.getElementById("profileGreeting").textContent = `안녕하세요. ${data.name}의 개인 페이지입니다.`;

                            document.getElementById("profileName").textContent = `${data.name}`;
                            document.getElementById("profileRole").textContent = `ROLE: ${data.role}`;
                            document.getElementById("profileMbti").textContent = `MBTI: ${data.mbti}`;

                            // 이미지 URL을 Firebase에서 가져와서 설정
                            const imageElement = document.getElementById("profileImage");
                            imageElement.src = data.image; // Firestore에서 가져온 이미지 URL을 사용
                        } else {
                            console.error("No such document!");
                        }
                    })
                    .catch((error) => {
                        console.error("Error getting document:", error);
                    });
            }
        };



        // 가져온 데이터를 HTML에 표시하는 함수
        function displayMemberData(memberData) {
            const profileName = document.getElementById("profileName");
            const profileRole = document.getElementById("profileRole");
            const profileImage = document.getElementById("profileImage");
            const profileMbti = document.getElementById("profileMbti");

            profileName.textContent = memberData.name;
            profileRole.textContent = memberData.role;
            profileImage.src = memberData.image; // 이미지 변경
            profileMbti.textContent = "MBTI: " + memberData.mbti; // MBTI 표시
        }

        // 페이지 로드 시 해당 멤버의 데이터 불러오기
        getMemberData(documentId);

    </script>
</head>

<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-12 text-center">
                <div class="intro">
                    <h2 id="profileName"> </h2> 
                    <div class="hello">
                        <h5 id="profileGreeting"></h5>
                    </div>
                </div>
                <div>
                    <img id="profileImage" alt="멤버 이미지" style="max-width: 200px; border-radius: 10px;">
                </div>
                <p id="profileRole">Role: </p>
                <p id="profileMbti">MBTI: </p>
            </div>
        </div>
    </div>

</body>

</html>